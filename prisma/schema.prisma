generator nextAdmin {
    provider              = "next-admin-generator-prisma"
  }
generator client {
  provider   = "prisma-client"
  output     = "./generated"
  engineType = "client"
}

datasource db {
  provider = "postgresql"
}

enum ComponentCategory {
  gpu
  cpu
  monitor
}

enum DeviceCategory {
  keyboard
  mouse
  headset
}

model Zone {
  id          Int   @id @default(autoincrement())
  slug        String   @unique
  name        String
  description String
  image       String
  price       String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @default(now())

  // Relations
  components ZoneComponent[]
  devices    ZoneDevice[]
  photos     ZonePhoto[]
}

model ZoneComponent {
  id       Int            @id @default(autoincrement())
  category ComponentCategory // "gpu", "cpu", "monitor"
  order    Int               @default(0)
  model    String
  specs    String
  zoneId   Int
  zone     Zone              @relation(fields: [zoneId], references: [id], onDelete: Cascade)
}

model ZoneDevice {
  id       Int         @id @default(autoincrement())
  category DeviceCategory // "keyboard", "mouse", "headset"
  order    Int            @default(0)
  model    String
  specs    String
  zoneId   Int
  zone     Zone           @relation(fields: [zoneId], references: [id], onDelete: Cascade)
}

model ZonePhoto {
  id     Int @id @default(autoincrement())
  url    String
  alt    String
  order  Int    @default(0)
  zoneId Int
  zone   Zone   @relation(fields: [zoneId], references: [id], onDelete: Cascade)
}

model Tournament {
  id                  String           @id @default(uuid(4))
  slug                String           @unique
  name                String
  description         String?
  date                DateTime
  time                String
  status              TournamentStatus @default(REGISTRATION)
  prize               String
  maxParticipants     Int
  currentParticipants Int              @default(0)
  image               String?
  rules               String?
  streamUrl           String?
  createdAt           DateTime         @default(now())
  updatedAt           DateTime         @updatedAt

  // Relations
  participants     TournamentPlayer[]
  matches          Match[]

  gameId           Int
  game             Game @relation(fields: [gameId], references: [id])
}

model Game {
  id          Int       @id @default(autoincrement())
  name        String
  tournaments Tournament[]
}

enum TournamentStatus {
  REGISTRATION
  ONGOING
  COMPLETED
  CANCELLED
}

model Player {
  id        String   @id @default(uuid(4))
  username  String   @unique
  nickname  String
  email     String?  @unique
  avatar    String?
  rating    Int      @default(1000)
  rank      Int?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  tournaments      TournamentPlayer[]
  matchesAsPlayer1 Match[]             @relation("Player1Matches")
  matchesAsPlayer2 Match[]             @relation("Player2Matches")
  matchesWon       Match[]             @relation("WinnerMatches")
  achievements     PlayerAchievement[]
  socialLinks      PlayerSocialLink[]
}

model PlayerAchievement {
  id          String            @id @default(uuid(4))
  name        String
  description String
  icon        String?
  rarity      AchievementRarity @default(COMMON)
  earnedAt    DateTime          @default(now())
  playerId    String
  player      Player            @relation(fields: [playerId], references: [id], onDelete: Cascade)
}

model TournamentPlayer {
  id           String   @id @default(uuid(4))
  placement    Int?
  prizeWon     String?
  registeredAt DateTime @default(now())

  tournamentId String
  tournament   Tournament @relation(fields: [tournamentId], references: [id], onDelete: Cascade)

  playerId String
  player   Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([tournamentId, playerId])
}

model Match {
  id       String   @id @default(uuid(4))
  game     String
  map      String?
  score    String? // e.g., "16-12" or "2-1"
  duration Int? // in minutes
  playedAt DateTime @default(now())

  tournamentId String?
  tournament   Tournament? @relation(fields: [tournamentId], references: [id], onDelete: SetNull)

  player1Id String
  player1   Player @relation("Player1Matches", fields: [player1Id], references: [id], onDelete: Cascade)

  player2Id String
  player2   Player @relation("Player2Matches", fields: [player2Id], references: [id], onDelete: Cascade)

  winnerId String?
  winner   Player? @relation("WinnerMatches", fields: [winnerId], references: [id], onDelete: SetNull)
}

enum AchievementRarity {
  COMMON
  RARE
  EPIC
  LEGENDARY
}

model PlayerSocialLink {
  id       String @id @default(cuid())
  platform String // steam, discord, twitch, youtube
  url      String
  playerId String
  player   Player @relation(fields: [playerId], references: [id], onDelete: Cascade)
}

model News {
  id           String    @id @default(uuid(4))
  slug         String    @unique
  title        String
  excerpt      String
  content      String
  image        String?
  category     String
  published    Boolean   @default(false)
  featured     Boolean   @default(false)
  authorName   String?
  authorAvatar String?
  publishedAt  DateTime?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  // Relations
  tags NewsTag[]
}

model NewsTag {
  id     Int @id @default(autoincrement())
  name   String
  newsId String
  news   News   @relation(fields: [newsId], references: [id], onDelete: Cascade)
}

model Admins {
  id        String   @id @default(uuid())
  username  String   @unique
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
